---
- name: Remove NoSchedule Taint from controllers
  become: false
  kubernetes.core.k8s_taint:
    state: absent
    name: "{{ node_name }}"
    taints:
    - effect: NoSchedule
      key: "node-role.kubernetes.io/control-plane"
  when: 
  - taint_controllers == false

- name: Add NoSchedule Taint to controllers
  become: false
  kubernetes.core.k8s_taint:
    state: present
    name: "{{ node_name }}"
    taints:
    - effect: NoSchedule
      key: "node-role.kubernetes.io/control-plane"
  when: 
  - taint_controllers == true